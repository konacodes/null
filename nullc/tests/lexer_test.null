-- nullc/tests/lexer_test.null
-- Basic tests for lexer functionality

@use "std/io.null"
@use "std/string.null"

fn test_char_is_digit() -> bool do
    -- Test digit detection
    if char_is_digit(48) == false do  -- '0'
        ret false
    end
    if char_is_digit(57) == false do  -- '9'
        ret false
    end
    if char_is_digit(65) == true do   -- 'A' should not be digit
        ret false
    end
    ret true
end

fn test_char_is_alpha() -> bool do
    -- Test alpha detection
    if char_is_alpha(65) == false do  -- 'A'
        ret false
    end
    if char_is_alpha(90) == false do  -- 'Z'
        ret false
    end
    if char_is_alpha(97) == false do  -- 'a'
        ret false
    end
    if char_is_alpha(122) == false do -- 'z'
        ret false
    end
    if char_is_alpha(48) == true do   -- '0' should not be alpha
        ret false
    end
    ret true
end

fn test_char_is_space() -> bool do
    if char_is_space(32) == false do  -- space
        ret false
    end
    if char_is_space(9) == false do   -- tab
        ret false
    end
    if char_is_space(10) == false do  -- newline
        ret false
    end
    if char_is_space(65) == true do   -- 'A' should not be space
        ret false
    end
    ret true
end

fn test_str_eq() -> bool do
    if str_eq("hello", "hello") == false do
        ret false
    end
    if str_eq("hello", "world") == true do
        ret false
    end
    if str_eq("", "") == false do
        ret false
    end
    ret true
end

fn test_str_len() -> bool do
    let len1 :: u64 = str_len("hello")
    if len1 != 5 do
        ret false
    end
    let len2 :: u64 = str_len("")
    if len2 != 0 do
        ret false
    end
    ret true
end

fn main() -> i32 do
    io_print("=== Lexer Tests ===")

    mut passed :: i64 = 0
    mut failed :: i64 = 0

    if test_char_is_digit() do
        io_print("test_char_is_digit: PASS")
        passed = passed + 1
    else do
        io_print("test_char_is_digit: FAIL")
        failed = failed + 1
    end

    if test_char_is_alpha() do
        io_print("test_char_is_alpha: PASS")
        passed = passed + 1
    else do
        io_print("test_char_is_alpha: FAIL")
        failed = failed + 1
    end

    if test_char_is_space() do
        io_print("test_char_is_space: PASS")
        passed = passed + 1
    else do
        io_print("test_char_is_space: FAIL")
        failed = failed + 1
    end

    if test_str_eq() do
        io_print("test_str_eq: PASS")
        passed = passed + 1
    else do
        io_print("test_str_eq: FAIL")
        failed = failed + 1
    end

    if test_str_len() do
        io_print("test_str_len: PASS")
        passed = passed + 1
    else do
        io_print("test_str_len: FAIL")
        failed = failed + 1
    end

    io_print("=== Lexer Tests Complete ===")
    if failed == 0 do
        ret 0
    end
    ret 1
end
